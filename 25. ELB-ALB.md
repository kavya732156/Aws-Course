***ELB (Elastic Load Balancer)***<br>
```
. Elastic Load Balancing (ELB) is a service from Amazon Web Services that automatically distributes incoming traffic across multiple targets such as EC2 instances, containers, and IP addresses.
. It helps improve: High Availability, Scalability, Fault Tolerance and Performance
. Target is the instance to which we need to redirect the traffic
. Target Group is used to maintain all the targets to which we need to send the traffic.
```
***Types of Load balancers under ELB***
```
1. Application Load Balancer  - ALB  → 2016
2. Network Load Balancer      - NLB → 2017
3. Gateway Load balancer      - GLB → 2019
4. Classic Load Balancer        - CLB  → Previous generation Load balancer → 2009
```
***1. Application Load Balancer- ALB***
```
Application Load Balancer (ALB)
Operates at Layer 7 (HTTP/HTTPS)
Best for web applications
Supports: Path-based routing and Host-based routing and WebSockets and Microservices
```
***Exercise***
***STEP 1: Launch 2 EC2 Instances (Different AZs – Mumbai)***
```
AWS Console → EC2 → Launch Instance
1. Instance 1:
  Name: Web-Server-1
  Region: Asia Pacific (Mumbai) – ap-south-1
  AMI: Amazon Linux 2
  Instance type: t2.micro
  Key pair: Select existing or create new
  VPC: Default VPC
  Subnet: Choose ap-south-1a
  Auto-assign Public IP: Enable
  Security Group: Allow HTTP (80) → 0.0.0.0/0 and Allow SSH (22) → Your IP andClick Launch

2. Instance 2 Configuration Repeat same steps but:
  Name: Web-Server-2
  Subnet: ap-south-1b andLaunch instance.
```
<img width="1549" height="446" alt="image" src="https://github.com/user-attachments/assets/38667e57-fb15-43ea-9ac1-dcbac67a7f3a" />

***STEP 2: Configure Web Server in Both Instances***
```
Instance 1:
sudo yum install httpd -y
sudo systemctl start httpd
sudo systemctl enable httpd
echo "<h1>This is Web Server 1</h1>" | sudo tee /var/www/html/index.html

Instance 2:

sudo yum install httpd -y
sudo systemctl start httpd
sudo systemctl enable httpd
echo "<h1>This is Web Server 2</h1>" | sudo tee /var/www/html/index.html
```
<img width="817" height="297" alt="image" src="https://github.com/user-attachments/assets/9048585a-aa30-497f-9c44-4227f36c749e" />
<img width="731" height="214" alt="image" src="https://github.com/user-attachments/assets/05aee4d6-db2d-4bf9-8154-cf0f7305429e" />

***STEP 3: Create Target Group***
```
Go to: EC2 → Target Groups → Create target group
Target type: Instances Name: ALB-TG
Protocol: HTTP and Port: 80 and VPC: Default VPC
Click Next
Register Instances Select both: Web-Server-1 and Web-Server-2 Click Include as pending
Click Create target group
```
<img width="1596" height="741" alt="image" src="https://github.com/user-attachments/assets/8b46e9df-7e9f-4425-9b28-f8184b5a8787" />

***STEP 4: Create Application Load Balancer***
```
Go to: EC2 → Load Balancers → Create Load Balancer
Select → Application Load Balancer
Configure ALB Name: My-ALB, Scheme: Internet-facing IP type: IPv4, VPC: Default VPC
Availability Zones: Select ap-south-1a and Select ap-south-1b
Security Group Allow: HTTP (80) → 0.0.0.0/0
Listener HTTP : 80
Forward to → Select your Target Group ALB-TG
Click Create Load Balancer
Wait for Status = Active
```
<img width="1549" height="757" alt="image" src="https://github.com/user-attachments/assets/64de60bb-989d-492b-8ee3-f5f85fa42dab" />

***STEP 5: Test ALB***
```
Go to: EC2 → Load Balancers
Copy the DNS Name and Paste in new browser tab:
Refresh multiple times You will see: This is Web Server 1 and This is Web Server 2
Load balancing is working
```
<img width="1009" height="249" alt="image" src="https://github.com/user-attachments/assets/63810207-a596-42c0-9e1a-fb0227ddebcf" />
<img width="899" height="243" alt="image" src="https://github.com/user-attachments/assets/b3c33512-e857-4f69-8341-cfc092027c5d" />

***Load Balancer Algortithms:***<br>

***1. Blue/Green Deployment***<br>
Blue/Green Deployment is a release strategy where you run two identical production environments and switch traffic between them with zero downtime.
```
| Environment | Purpose                    |
| ----------- | -------------------------- |
|    Blue     | Current live production    |
|    Green    | New version of application |
```
***How to Implement in AWS (Simple ALB Method)***
```
Create two Target Groups: TG-Blue and TG-Green
Attach Blue instances to TG-Blue
Attach Green instances to TG-Green
In ALB: Listener → Forward to TG-Blue (initially)
When ready: Change listener → Forward to TG-Green
Done
```
***Advantages***<br>
1. Zero downtime deployment
2. Instant rollback
3. Safe production release
4. Easy testing before go-live
5. Reduced deployment risk

***Disadvantages***<br>
1. Double infrastructure cost
2. Database schema sync complexity
3. Slightly higher setup effort

***2.  Canary Deployment***<br>
Canary Deployment is a release strategy where a new version of an application is released to a small percentage of users first, while the majority continue using the stable version.<br>
It is commonly implemented in AWS using: Elastic Load Balancing, Amazon EC2, AWS CodeDeploy and Amazon Route 53<br>
new version is stable before a full release.
***Use Cases:***<br>
Testing new features with real user traffic.<br>
Verifying performance and reliability under limited usage.<br>
Incremental rollouts to reduce deployment risks.<br>

***3. Stickiness (Session Persistence)***<br>
1. Stickiness, also called Session Persistence, ensures that a user’s requests are always routed to the same backend server during a session.
2. In AWS, this is commonly configured in:
3. Elastic Load Balancing and Works with Amazon EC2 instances behind a Load Balancer
4. By default, load balancers distribute traffic (Round Robin).
5. Example without stickiness:
   Request 1 → Server A
   Request 2 → Server B
   Request 3 → Server C
6. This can cause issues if: User login session is stored locally on one server and Shopping cart data is stored in server memory and User may get logged out or lose session.

***How to Enable Stickiness (ALB)***
```
Go to EC2 → Target Groups, Select Target Group, Click Attributes, Enable: Stickiness → On
Choose duration (e.g., 3600 seconds)
```

***4. Elastic Load Balancing – Network Load Balancer (NLB)***<br>
It works at Layer 4 (Transport Layer) and handles TCP, UDP, and TLS traffic.<br>
NLB distributes traffic using a Flow Hash (5-Tuple Hash) algorithm.<br>
NLB calculates a hash based on: Source IP, Source Port, Destination IP, Destination Port and Protocol (TCP/UDP)<br>
This combination uniquely identifies a connection (flow).
For every new connection:
1. NLB calculates hash of the 5-tuple
2. Selects a target (EC2/IP)
3. All packets of that connection go to the same target
Ensures connection consistency.
Unlike ALB, NLB does NOT use Round Robin

***Differences***
```
| Feature                 |      Blue/Green Deployment |    Canary Deployment                |    Stickiness (Session Persistence)         |
| ----------------------- | -------------------------- | ----------------------------------- | ------------------------------------------- |
| **Purpose**             | Zero-downtime full release | Gradual release to small % users    | Keep user connected to same server          |
| **Traffic Shift**       | 100% switch at once        | Gradual (10% → 50% → 100%)          | No traffic shifting (session-based routing) |
| **Risk Level**          | Low                        | Very Low                            | Not a deployment strategy                   |
| **Rollback**            | Instant (switch back)      | Gradual rollback                    | Not applicable                              |
| **Infrastructure**      | Two identical environments | Two versions running simultaneously | Same environment                            |
| **User Impact**         | All users moved at once    | Only small group affected first     | Users stay on same backend                  |
| **Used For**            | Version upgrades           | Safe feature testing                | Login/session-based apps                    |
| **Monitoring Required** | Moderate                   | High                                | Low                                         |
| **Cost**                | Higher (duplicate infra)   | Moderate                            | No extra infra                              |
| **Example**             | Switch TG-Blue → TG-Green  | 90% old / 10% new                   | Same user always hits Server 1              |
```




